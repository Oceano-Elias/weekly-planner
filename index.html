<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Planner | Hierarchical Task Management</title>
    <meta name="description"
        content="Desktop weekly planner with hierarchical tasks, drag-and-drop scheduling, and department-based organization">

    <!-- PWA -->
    <link rel="manifest" href="./manifest.json" />
    <link rel="icon" type="image/png" href="./icon.png" />
    <link rel="apple-touch-icon" href="./icon.png" />

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a1d2e" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- CSS is bundled by Vite via main.js imports -->
    <script type="module" src="./src/main.js"></script>
</head>

<body>
    <!-- Premium Mesh Gradient Background -->
    <div class="mesh-gradient"></div>

    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="header-title">Weekly Planner <span class="version-badge" id="versionBadge"></span></h1>
                <div class="header-nav">
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="week">Week</button>
                        <button class="view-btn" data-view="day">Day</button>
                    </div>
                    <button class="nav-btn" id="prevWeek" title="Previous Week">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M15 18l-6-6 6-6" />
                        </svg>
                    </button>
                    <span class="week-display" id="weekDisplay">January 5 - 11, 2026</span>
                    <button class="nav-btn" id="nextWeek" title="Next Week">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M9 18l6-6-6-6" />
                        </svg>
                    </button>
                    <button class="nav-btn" id="todayBtn" title="Go to Today"
                        style="margin-left: 8px; width: auto; padding: 0 12px; font-size: 12px;">
                        Today
                    </button>
                    <div class="template-controls"
                        style="display: flex; gap: 8px; border-left: 1px solid var(--border-color); padding-left: 12px; margin-left: 12px;">
                        <button class="nav-btn" id="setTemplateBtn" title="Set Current Week as Default Template"
                            style="width: auto; padding: 0 12px; display: flex; align-items: center; gap: 6px;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                <polyline points="7 3 7 8 15 8"></polyline>
                            </svg>
                            <span style="font-size: 11px;">Set Template</span>
                        </button>
                        <button class="nav-btn" id="resetWeekBtn" title="Reset Week to Default Template"
                            style="width: auto; padding: 0 12px; display: flex; align-items: center; gap: 6px;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                                <path d="M3 3v5h5"></path>
                            </svg>
                            <span style="font-size: 11px;">Reset</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <!-- Utility Button Group -->
                <div class="btn-group">
                    <button class="nav-btn shortcuts-btn" id="shortcutsBtn"
                        title="N: New Task | T: Today | W: Week | D: Day | F: Focus | ‚Üê‚Üí: Navigate">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="2" y="4" width="20" height="16" rx="2" />
                            <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M8 12h8M6 16h.01M10 16h.01M14 16h.01" />
                        </svg>
                        <span class="btn-label-sm">?</span>
                    </button>
                    <button class="nav-btn" id="settingsBtn" title="Department Settings">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3" />
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
                        </svg>
                        <span class="btn-label">Settings</span>
                    </button>
                    <button class="nav-btn" id="printPdfBtn" title="Export as PDF / Print">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="6 9 6 2 18 2 18 9" />
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
                            <rect x="6" y="14" width="12" height="8" />
                        </svg>
                        <span class="btn-label">Print</span>
                    </button>
                    <button class="nav-btn" id="exportDataBtn" title="Export Data Backup (JSON)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="7 10 12 15 17 10" />
                            <line x1="12" y1="15" x2="12" y2="3" />
                        </svg>
                        <span class="btn-label">Export</span>
                    </button>
                    <button class="nav-btn" id="importDataBtn" title="Import Data Backup">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                        <span class="btn-label">Import</span>
                    </button>
                    <button class="nav-btn" id="weeklySummaryBtn" title="Weekly Summary">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M3 3v18h18" />
                            <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3" />
                        </svg>
                        <span class="btn-label">Summary</span>
                    </button>
                    <input type="file" id="importFileInput" accept=".json" style="display: none;">
                </div>

                <!-- Divider -->
                <span class="header-divider"></span>

                <!-- Primary Action -->
                <button class="btn btn-primary btn-glow" id="newTaskBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14M5 12h14" />
                    </svg>
                    New Task
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-toggle-row">
                    <button class="sidebar-toggle" id="sidebarToggle" title="Toggle Sidebar">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M15 18l-6-6 6-6" />
                        </svg>
                    </button>
                </div>
                <div class="sidebar-inner">
                    <div class="sidebar-tabs">
                        <button class="sidebar-tab active" data-tab="queue">Tasks</button>
                        <button class="sidebar-tab" data-tab="analytics">Analytics</button>
                        <button class="sidebar-tab" data-tab="filters">Filters</button>
                    </div>

                    <!-- Search Bar (Always visible in Task Queue) -->
                    <div class="sidebar-search" id="sidebarSearch">
                        <div class="search-input-wrapper">
                            <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8" />
                                <path d="m21 21-4.3-4.3" />
                            </svg>
                            <input type="text" id="taskSearchInput" placeholder="Search tasks..." class="search-input">
                            <button class="search-clear" id="searchClearBtn" title="Clear search">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M18 6L6 18M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Task Queue Panel -->
                    <div class="sidebar-content" id="queuePanel">
                        <div class="task-queue" id="taskQueue">
                            <div class="task-queue-empty">
                                <div class="task-queue-empty-icon">üìã</div>
                                <p>No tasks in queue</p>
                                <p style="font-size: 12px; margin-top: 8px;">Click "New Task" to create one</p>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Panel -->
                    <div class="sidebar-content" id="analyticsPanel" style="display: none;">
                        <div class="analytics-container" id="analyticsContainer">
                            <!-- Stats will be generated dynamically -->
                        </div>
                    </div>

                    <!-- Filters Panel -->
                    <div class="sidebar-content" id="filtersPanel" style="display: none;">
                        <div class="filter-panel" id="filterTree"></div>
                    </div>
                </div>
            </aside>

            <!-- Calendar -->
            <div class="calendar-container">
                <!-- Calendar Header (Days) -->
                <div class="calendar-header" id="calendarHeader">
                    <div class="calendar-header-cell"></div>
                    <!-- Days will be generated dynamically -->
                </div>

                <!-- Calendar Grid -->
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Time column and day columns will be generated dynamically -->
                </div>
            </div>
        </main>
    </div>

    <!-- Task Creation Modal -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Create New Task</h2>
                <button class="modal-close" id="closeModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <!-- Task Title -->
                    <div class="form-group">
                        <label class="form-label" for="taskTitle">Task Title *</label>
                        <input type="text" class="form-input" id="taskTitle" placeholder="Choose department..." required
                            readonly>
                    </div>



                    <!-- Schedule Info (shown when creating from calendar click) -->
                    <div class="form-group" id="scheduleInfo" style="display: none;">
                        <label class="form-label">Scheduled For</label>
                        <div class="schedule-preview">
                            <span id="scheduleDayDisplay"></span>
                            <span class="schedule-separator">at</span>
                            <span id="scheduleTimeDisplay"></span>
                            <span class="schedule-max-info" id="scheduleMaxInfo"></span>
                        </div>
                    </div>

                    <!-- Department Hierarchy -->
                    <div class="form-group">
                        <label class="form-label">Department Hierarchy *</label>
                        <div class="hierarchy-selector" id="hierarchySelector">
                            <div class="hierarchy-level">
                                <span class="hierarchy-level-indicator">1</span>
                                <select class="form-select" id="dept1" required>
                                    <option value="">Select Department</option>
                                </select>
                            </div>
                            <div class="hierarchy-level" id="deptLevel2" style="display: none;">
                                <span class="hierarchy-level-indicator">2</span>
                                <select class="form-select" id="dept2">
                                    <option value="">Select Sub-Department</option>
                                </select>
                            </div>
                            <div class="hierarchy-level" id="deptLevel3" style="display: none;">
                                <span class="hierarchy-level-indicator">3</span>
                                <select class="form-select" id="dept3">
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                            <div class="hierarchy-level" id="deptLevel4" style="display: none;">
                                <span class="hierarchy-level-indicator">4</span>
                                <select class="form-select" id="dept4">
                                    <option value="">Select Sub-Category</option>
                                </select>
                            </div>
                        </div>
                        <div class="hierarchy-path-preview" id="hierarchyPreview" style="display: none;"></div>
                    </div>

                    <!-- Duration -->
                    <div class="form-group">
                        <label class="form-label">Duration *</label>
                        <div class="duration-selector">
                            <button type="button" class="duration-option" data-duration="30">30m</button>
                            <button type="button" class="duration-option selected" data-duration="60">1h</button>
                            <button type="button" class="duration-option" data-duration="90">1.5h</button>
                            <button type="button" class="duration-option" data-duration="120">2h</button>
                            <button type="button" class="duration-option" data-duration="custom">Custom</button>
                        </div>
                        <div class="duration-custom" id="customDuration" style="display: none;">
                            <input type="number" class="form-input duration-custom-input" id="customMinutes" min="15"
                                max="480" step="15" placeholder="Min">
                            <span
                                style="color: var(--text-secondary); display: flex; align-items: center;">minutes</span>
                        </div>
                    </div>

                    <!-- Mini-Tasks/Steps (Optional) -->
                    <div class="form-group">
                        <label class="form-label">Steps / Mini-Tasks <span
                                class="form-label-optional">(optional)</span></label>
                        <div class="steps-input-wrapper">
                            <input type="text" class="form-input" id="stepInput"
                                placeholder="Add a step and press Enter...">
                            <button type="button" class="btn-add-step" id="addStepBtn" title="Add Step">+</button>
                        </div>
                        <ul class="steps-list" id="stepsList"></ul>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelTask">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveTask">Create Task</button>
            </div>
        </div>
    </div>

    <!-- Focus Mode Modal -->
    <div id="focusModeContainer"></div>

    <!-- Keyboard Shortcuts Modal -->
    <div class="shortcuts-modal" id="shortcutsModal">
        <div class="shortcuts-overlay" id="shortcutsOverlay"></div>
        <div class="shortcuts-content">
            <div class="shortcuts-header">
                <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                <button class="shortcuts-close" id="closeShortcuts">√ó</button>
            </div>
            <div class="shortcuts-body">
                <div class="shortcut-group">
                    <h4>Navigation</h4>
                    <div class="shortcut-item"><kbd>‚Üê</kbd> <span>Previous Week/Day</span></div>
                    <div class="shortcut-item"><kbd>‚Üí</kbd> <span>Next Week/Day</span></div>
                    <div class="shortcut-item"><kbd>T</kbd> <span>Go to Today</span></div>
                </div>
                <div class="shortcut-group">
                    <h4>Views</h4>
                    <div class="shortcut-item"><kbd>W</kbd> <span>Week View</span></div>
                    <div class="shortcut-item"><kbd>D</kbd> <span>Day View</span></div>
                </div>
                <div class="shortcut-group">
                    <h4>Tasks</h4>
                    <div class="shortcut-item"><kbd>N</kbd> <span>New Task</span></div>
                    <div class="shortcut-item"><kbd>F</kbd> <span>Focus</span></div>
                    <div class="shortcut-item"><kbd>‚åò</kbd> + <kbd>Enter</kbd> <span>Save Task</span></div>
                </div>
                <div class="shortcut-group">
                    <h4>General</h4>
                    <div class="shortcut-item"><kbd>Esc</kbd> <span>Close Modal</span></div>
                    <div class="shortcut-item"><kbd>?</kbd> <span>Show Shortcuts</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Weekly Summary Modal Container -->
    <div id="weeklySummaryContainer"></div>
</body>

</html>